plugins {
    id "java"
    id "java-library"
    id "eclipse"
    id "idea"
    id "antlr"
    id "maven"
    id "maven-publish"
    id "com.jfrog.bintray" version "1.7.3"
}

repositories {
    mavenCentral()
    maven {
         url  "http://first.wpi.edu/FRC/roborio/maven/release/"
    }
}

dependencies {
	//Antlr Dep
    antlr "org.antlr:antlr4:4.7"

    //General Deps
    compile group: 'commons-cli', name: 'commons-cli', version: '1.4'
    compile group: 'com.squareup', name: 'javapoet', version: '1.9.0'
    compile group: 'org.dom4j', name: 'dom4j', version: '2.1.0'

    //Test Deps
    testCompile group: 'junit', name: 'junit', version: '4.12'

    //FRC Deps
    compile group: 'edu.wpi.first.ntcore', name: 'ntcore-java', version: '4.0.0'
    compile group: 'edu.wpi.first.cscore', name: 'cscore-java', version: '1.1.0'
    compile group: 'edu.wpi.first.wpilibj', name: 'wpilibj-java', version: '2018.1.1'
    compile group: 'edu.wpi.first.wpiutil', name: 'wpiutil-java', version: '3.0.0'
    compile group: 'org.opencv', name: 'opencv-java', version: '3.2.0'
}

generateGrammarSource {
    arguments += ["-package", "rpl"]
}

publishing {
    publications {
        robotlib(MavenPublication) {
            groupId 'team6479.robotrepo'
            artifactId 'robotlib'
            version projectVersion

            from components.java
        }
    }
}

bintray {
    user = bintrayUser
    key = bintrayKey
    publications = ['robotlib']

    dryRun = false
    publish = true

    pkg {
        repo = 'RobotRepo'
        name = 'robotlib'
        userOrg = 'team6479'
        version {
            name = projectVersion
            desc = 'Robotlib release 1.3.0'
        }
    }
}

task wrapper(type: Wrapper) {
    gradleVersion = '4.4.1'
}